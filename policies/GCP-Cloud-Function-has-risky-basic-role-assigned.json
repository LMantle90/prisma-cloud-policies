{
  "policyUpi": "PC-GCP-RM-1060",
  "policyId": "95a9e34b-0274-42b8-89cc-8f3dbb3e0ea8",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "medium",
  "name": "GCP Cloud Function has risky basic role assigned",
  "description": "Cloud Functions assigned overly permissive 'basic' roles pose a significant security risk. These roles grant extensive project access, increasing the impact of a compromise.\n\nGCP Cloud Functions utilize IAM roles to control access. 'Basic' roles, unlike more granular roles introduced later, provide broad permissions. An attacker gaining control of a Cloud Function with a 'basic' role could potentially access and modify all project resources, leading to data breaches or service disruptions.\n\nExploiting this misconfiguration could result in complete project compromise, data exfiltration, unauthorized resource modification, or even complete service disruption. Using least privilege, by assigning only necessary permissions, significantly reduces the attack surface and limits the damage from a potential compromise.\n\nRemediate this by replacing 'basic' roles with custom roles granting only the necessary roles for the Cloud Function. Regularly review assigned roles to ensure continued adherence to the principle of least privilege. This mitigates risk by limiting potential damage from a compromised Cloud Function.",
  "rule.criteria": "56159411-7796-49a4-8217-14fafc3634a2",
  "searchModel.query": "config from cloud.resource where api.name = 'gcloud-projects-get-iam-user' AND json.rule = roles[*] contains \"roles/editor\" or roles[*] contains \"roles/owner\" as X; config from cloud.resource where api.name = 'gcloud-cloud-function' as Y; filter '$.Y.serviceAccountEmail equals $.X.user'; show Y;",
  "recommendation": "It is recommended to the principle of least privilege for granting access.\n\nTo assign desired service account to the cloud funtion, please refer to the URL given below:\nhttps://cloud.google.com/functions/docs/securing/function-identity#individual\n\nTo update priviledges granted to a service account, please refer to the URL given below:\nhttps://cloud.google.com/iam/docs/granting-changing-revoking-access",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM) (Latest)",
    "CIS Controls v8.1",
    "HIPAA",
    "ISO/IEC 27001:2022",
    "Insurance Regulatory And Development Authority Of India",
    "MITRE ATT&CK v15.1 Cloud IaaS for Enterprise",
    "NCSC - Cyber Essentials",
    "NCSC Cloud Security Principles",
    "NIST 800-53 Rev 5",
    "SOC 2",
    "Secure Controls Framework (SCF) - 2024.2",
    "TX-RAMP Level 1"
  ]
}