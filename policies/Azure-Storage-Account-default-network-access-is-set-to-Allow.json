{
  "policyUpi": "PC-AZR-STO-404",
  "policyId": "991aca47-286f-45be-8737-ff9c069beab6",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "informational",
  "name": "Azure Storage Account default network access is set to 'Allow'",
  "description": "Azure Storage accounts with default network access set to 'Allow' are susceptible to unauthorized data access. This misconfiguration exposes storage account resources to any network, increasing the risk of data breaches and unauthorized modifications.\n\nAzure Storage accounts offer a 'Network rules' setting to control inbound traffic. By default, 'Allow' grants access from any IP address. Untrusted IPs can exploit this, leading to data exfiltration, ransomware attacks, or malicious data manipulation. Restricting network access enhances security posture significantly.\n\nThe impact of this misconfiguration includes data breaches, unauthorized resource modification, and potential compliance violations. Implementing strong access controls through network rules is crucial to protect sensitive data and maintain regulatory compliance. Restricting access to only authorized networks minimizes the attack surface.\n\nTo mitigate this risk, configure your Azure Storage accounts to explicitly allow access only from trusted IP addresses or virtual networks. Utilize the 'Network rules' setting within the storage account configuration to define specific allowed networks. Regularly review and update these rules as your infrastructure evolves.",
  "rule.criteria": "0c8ba0ca-2414-4d62-897c-4b57a291ae2b",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-storage-account-list' AND json.rule = properties.publicNetworkAccess equal ignore case \"Enabled\" AND networkRuleSet.defaultAction equal ignore case \"Allow\"",
  "recommendation": "To change the default network access rule, follow below URL:\nhttps://learn.microsoft.com/en-us/azure/storage/common/storage-network-security?tabs=azure-portal#change-the-default-network-access-rule",
  "remediable": true,
  "remediation.cliScriptTemplate": "az storage account update --name ${resourceName} --resource-group ${resourceGroup} --default-action Deny",
  "remediation.description": "This CLI command requires 'Microsoft.Storage/storageAccounts/*' permission. Successful execution will disable default network access rule for Storage Accounts.'.",
  "remediation.impact": "disables default-action in Azure Storage Account network access",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "ACSC Information Security Manual (ISM) (Latest)",
    "APRA (CPS 234) Information Security",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 1",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 2",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 3",
    "Azure Security Benchmark (v2)",
    "Azure Security Benchmark (v3)",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CIS v1.1 (Azure)",
    "CIS v1.2.0 (Azure)",
    "CIS v1.3.0 (Azure)",
    "CIS v1.3.1 (Azure)",
    "CIS v1.4.0 (Azure)",
    "CIS v1.5.0 (Azure) - Level 1",
    "CIS v2.0.0 (Azure) Level 1",
    "CIS v2.1.0 (Azure) Level 1",
    "CIS v3.0.0 (Azure) Level 1",
    "CSA CCM v.4.0.1",
    "CSA CCM v4.0.12",
    "CyberSecurity Law of the People's Republic of China",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "Fedramp (Moderate)",
    "Framework for Adoption of Cloud Services by SEBI Regulated Entities (REs)",
    "GDPR",
    "HITRUST CSF v.11.2.0",
    "HITRUST v.9.4.2 [Deprecated]",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "ISO/IEC 27018:2019",
    "Insurance Regulatory And Development Authority Of India",
    "MITRE ATT&CK v10.0 [Deprecated]",
    "MITRE ATT&CK v12",
    "MITRE ATT&CK v13.0 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v14.0 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v15.1 Cloud IaaS for Enterprise",
    "MLPS 2.0",
    "MLPS 2.0 (Level 2)",
    "Microsoft Cloud Security Benchmark v1",
    "NCSC - Cyber Essentials",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-171 Revision 3",
    "NIST SP 800-172",
    "NYDFS 23 CRR-NY 500.0",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0.1",
    "PIPEDA",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2",
    "Telecommunications Security Act - TSA"
  ]
}