{
  "policyUpi": "PC-GCP-GKE-204",
  "policyId": "1478c66d-2911-4a19-80fb-ddc36ab2a270",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "medium",
  "name": "GCP Kubernetes Engine private cluster has private endpoint disabled",
  "description": "This policy identifies GCP Kubernetes Engine private clusters with private endpoint disabled. A public endpoint might expose the current cluster and Kubernetes API version and an attacker may be able to determine whether it is vulnerable to an attack. Unless required, disabling the public endpoint will help prevent such threats, and require the attacker to be on the master's VPC network to perform any attack on the Kubernetes API. It is recommended to enable the private endpoint and disable public access on Kubernetes clusters.",
  "rule.criteria": "f698d4a8-6ee8-40b4-9cf1-211901b00ca3",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-container-describe-clusters' AND json.rule = status equals RUNNING and privateClusterConfig exists and privateClusterConfig.enablePrivateEndpoint does not exist",
  "recommendation": "Once a cluster is created without enabling Private Endpoint, it cannot be remediated. Rather, the cluster must be recreated. \nTo create the private cluster with public access disabled, refer to the below link,\nhttps://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters#private_cp\n\nTo resolve the alert, ensure deletion of the old cluster after the new private cluster is created and is in running state and once all the data has been migrated.",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "APRA (CPS 234) Information Security",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CIS v1.0.0 (GCP)",
    "CIS v1.1.0 (GKE)",
    "CIS v1.2.0 (GKE)",
    "CIS v1.3.0 (GKE) - Level 2",
    "CIS v1.4.0 (GKE) - Level 2",
    "CIS v1.5.0 (GKE) - Level 2",
    "CSA CCM v.4.0.1",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "FFIEC",
    "HITRUST v.9.4.2 [Deprecated]",
    "ISO 27001:2013",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "ISO/IEC 27018:2019",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0",
    "PIPEDA",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1"
  ]
}